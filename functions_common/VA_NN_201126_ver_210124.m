function [y1] = VA_NN_201126(x1)
%VA_NN_201126 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 24-Jan-2021 04:38:33.
% 
% [y1] = VA_NN_201126(x1) takes these arguments:
%   x = 5xQ matrix, input #1
% and returns:
%   y = 15xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-3.97112032289276;-1.03389311607627;-0.000290101440903674;-530;-1];
x1_step1.gain = [0.267536326567491;0.609032685718809;2.28951035159361;0.00188679245283019;1.42348754448399];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.829955171127188196;5.366731953340572403;0.38980347023887884639;-1.7592700355225276976;-1.903258785112296847;-2.7104567921126450081;-4.6364633580237732957;-1.2000128046278377703;-1.4829697024404893124;-3.0249353012592257173;-2.1944594028160886445;5.0721948062792101553;-3.3953177404087173663;3.942555501455109912;8.7196224912846904687];
IW1_1 = [4.8077123449233516439 -1.3670142191436853718 4.1308926937045615801 -0.080346403722690348803 -2.0957888182180322012;2.1878641741539688326 -7.3170853439745284774 5.5326596802950351872 -4.6063914058970460985 2.0286418200616598284;-3.5472850203281773851 -2.2889222286621042635 -7.5074546624220195312 3.9217349998002308809 -6.8757350416953526562;2.529360738614548243 3.0006460529927458936 2.3968252071131934677 0.048314057442102105455 -2.1506708633991329371;2.9222345299350562797 -5.0739255527779469901 1.5776073267777639408 1.334472994065605711 2.0601955226250057152;-9.7867247490312507807 -3.7309361661145228339 2.5132142123736560535 -2.0432779178074844673 5.9822679305730757093;-0.33604953836523343558 2.4341717583148265724 1.1131025555807827487 6.7520399584219283895 -9.6886130792571041326;2.7199853013038697291 -1.0565831375862348995 2.4114276085932937477 -2.426701647092410763 -0.82347661522648041288;0.76349413882222838534 5.16757718883535766 -1.6054662156076093815 5.3073541627872575788 -1.0749791164224191675;-1.029644503525656507 -1.5016415340812916401 4.4169533923706172374 2.4390171672274973957 -3.2067197825724562676;-5.6115417212243050571 3.6336531758229062561 0.012269394588076198288 -0.5477500659527225757 -0.58407373464268663721;4.2580981129753778802 -5.5340677382594360978 -0.46716174511669977809 8.871599299152247653 0.22718502376153781874;-2.9654085889034225154 -0.98568142543473347139 0.39774445906818750585 -0.9235794835805487546 -5.2468094299258138946;0.39856557763138189543 -0.21172708536531123502 2.3767116455944692355 0.80765098812457969402 -2.5808036625761747729;4.0705803048604600747 7.193476807003422735 -0.81867039775806682567 2.0080484771318083403 3.6053548434844056025];

% Layer 2
b2 = [-5.4822329820117357002;1.7488550380413987462;4.3659490710304691419;5.0537377961493108458;2.1890311838101754738;4.1250957647511841131;0.67976151705739273901;1.0408935924076343493;-10.085483212272738029;-0.8347708440612733316;9.4851784387876083571;6.325634334810404269;3.120045168225340948;-2.9511195514504504622;1.6290856577919226034];
LW2_1 = [5.3036766752435928751 -2.2819730189451603586 1.8542388880148885644 -3.0644322782884256817 4.1540859180045019983 6.713783246043600883 -0.68212843169000603183 5.0605561875054645427 -6.4330901942971694396 -3.5243155932168801492 1.7477951266446334344 3.458227869547344735 3.4549348403174295896 1.4222326480334253063 2.5978229953945266573;3.6436165309376020716 -0.13750261934720214851 0.53630212980842750792 -1.986770400855382368 -9.5309175249452771084 2.0142963432356295606 8.6903846068405901093 2.0517513354630625422 -3.029963670240444884 -5.0132262096048805233 -6.2589848075532872329 1.464192832135087885 2.7930207673577829297 4.2478210544245689206 -1.5228814267175383446;-11.09849935675409327 -1.7825578276416838008 4.3599166885503892743 11.284528886384817881 -2.994460911270814929 -3.1941946834602461536 -8.0253886712083826183 0.014025094160174177843 4.8929561006795792011 4.16934928411893857 -4.2820126016691126836 -6.6639332238916786366 -4.0803648141900348278 11.867489720501401607 2.0623768725808022673;5.3580618940571671516 -0.25717666991387083675 0.078595400531635786767 5.7988812322240086417 -2.5912718224884314644 -5.1702314633845682934 -1.2280480348000017976 2.1979889626709376849 -8.7656127047539307284 -4.7696111005146599737 1.7534065076465092936 4.9402824854727747095 -1.7340408381251477543 1.4094567869017382566 4.4930835456282132157;-11.883134152908166215 -1.6807969494875441008 1.3138647677222139443 5.8086456817310301304 5.3885976805387372224 -6.1989624973731167756 -2.5551096042420327059 -8.112242822558719979 2.9576356440193496411 1.3694911950300063808 11.316107098879546911 2.9347278348431498074 0.52502355930460464783 1.0744116410470290202 5.7195027509883704653;-7.7492097434004127976 13.105570433707852018 3.0928407849890922066 3.5782305639203850767 2.8152146179171917417 -1.6002836715721335814 -7.6331450719975180164 10.704558241458650869 9.9704440265259766107 1.4778878131262511708 1.2458045094911303075 1.4263250813841024112 -11.549192911436776399 5.5247460794611527035 -15.240459022779024423;1.9183579101393968269 0.12424369903512828828 0.080394973135489600224 0.70253870153522102182 -1.4073203040141111231 -1.3349136393289826596 -0.39826603849201192009 0.38101694054158236069 1.7488605205535632248 0.13341013226595149765 -1.1863050721267116572 0.99770855113860390517 2.3544453079889846592 -4.3255202909316903259 -1.3400311915469926838;-1.6088576416292241777 0.95609232211584693761 7.5355026400914093543 4.392574743310293961 5.5518611360937759613 -5.62243877987995333 4.7948621559685635773 2.2012441403737650347 -0.64683236765898832754 -0.51524992886969744887 8.6406644328189852189 2.3490193036336743937 -3.8528636743225597172 -0.33444434458004468347 3.2250154660619521074;-3.3183040771419460846 5.0873992919915718147 0.39829816072119905712 4.4151924670559017372 -2.1592008068681241006 2.8301212400422328663 2.331671795872650943 5.2464004728429447511 5.0366692758132263208 -13.175431644721529167 4.3921265864522771594 -2.4908042316243403924 2.0062351024086009232 3.0212890308398718808 14.516807427489998972;6.8077714335191270578 1.1529471747780752899 3.3135514059068320591 3.2907894121281437982 -11.303233478047580718 -0.38136499050770950037 -1.0447364742049507491 5.9968009459928293126 -1.4365759520140797267 -1.2052876226203366183 4.1418572302593279488 1.950863078520551408 -2.1472464957048007506 2.5647208209515559574 -1.8066141665917172521;-0.24855693810564577495 8.0193394050212543078 0.74440247301909212574 -1.0334665645418565916 3.8510655035095271437 -11.285653922384833336 -1.6642027053768029266 -7.3707719161074498615 17.470862177370047874 -3.7556188229706264359 6.6944960385310334772 3.8350973970475861208 0.38664829284498547501 -3.284267797611459816 3.7190302156669465816;-2.6851932490524279551 -0.33771977866631391896 -8.2192424780909174586 3.3049470674654566338 -14.361682748009044985 -8.84790990286433221 3.4778220510352291228 -0.45251000945475705617 -12.959417970424228272 2.452692568317800248 -4.7057422489875877503 -0.49616690396935358986 3.5386240077082087296 -3.7403012158650046359 0.22949243786789758071;-1.477739028383666664 1.2863573929451437294 0.34488866984576443953 0.20055317705627159763 -2.8554483302838318259 -0.21189954269622920946 3.2159730829405059893 2.5179332171364725568 0.31650837395221986803 -4.6310251244386737568 2.1520787982351134993 0.19491497187769743493 7.7405550290651223833 -3.8269766450515660949 5.6957697332130470258;5.7471328597606463617 -2.8146918472764936858 -0.57443381423305250877 -2.5737590202425164598 -3.4439013342032978038 0.60465680569838176073 0.31489841027088183445 -1.0604656050588898708 2.7235724882045984074 4.3876299576717237017 -2.6596297317743551325 -7.1230660346217140599 10.863892493637877124 -2.94991954512975596 -0.30243995076900015428;0.84251316219191740853 -0.56053818648568276561 1.586962232837903386 2.0122974554113168821 5.9489707827223563541 -0.18652064788517194738 -1.65289477803449536 -3.3892528394583760765 -0.59620904894833814947 -3.0637746155525258374 -1.4299831790796300179 -0.57313940697985388262 0.18940427336546367121 -0.31774517350711944941 -0.88228590600706080505];

% Layer 3
b3 = [-10.397727529058931495;0.63883307892168650355;1.1406697849639937381;-0.71918401134055442991;-4.2503171730753486202;-4.9519861763587078585;-4.3024864839454037835;2.269189245697999624;-5.4202510272015524961;5.6040676402704070469;3.8811736892076802441;5.2806609103893915602;6.6457944956239982659;0.27378765340705724096;6.3448727538116997948];
LW3_2 = [-7.6746620647639032242 -2.3771487880177679664 3.4060335974359654543 -0.48578440093269587008 0.091700068679185273157 -7.7200187033653584479 -8.6735841440246179701 11.560784671569527049 -1.4373237217226317863 -10.337590349645610743 5.5882882465989496268 -2.5190410241195313468 -2.3731692588250417053 3.5605153726514258139 6.9375885776087269363;-5.8983107817561588604 -2.8128947275531319683 5.0590205632825160365 -12.099558198630486316 -2.50792050209912043 4.4412000757318628175 3.6483942171522714126 -5.4768580572452432165 2.8283550502581875641 6.2484920257101306262 12.95028144783061741 -5.6202859163794878228 -1.4608695499634918313 2.4514319957226389235 0.49164630306982082253;-4.2953592246310128289 -0.91037679307071162071 -6.7528441784884831733 -7.8415617084201851839 -1.6536580452637434924 3.2114561973076258816 -1.336913388108521783 0.34285847786510070812 2.8979051275515859132 1.5263131696620779731 8.8240479004458780565 -6.1889989587266862614 2.8459977201863857488 -6.3572196902770459204 -0.25099642777319308706;6.6013502757739805915 -2.4891136203671173632 4.6350936294583142683 -1.4547821331915511411 -0.42394587377130915629 -2.478710584744550971 -3.4055984510737138393 -2.7585068911356209753 1.194268126256914142 1.5926427056843164287 0.21305250111381029976 5.8885455909074657654 2.6506821802499640484 0.641153000889852831 1.075659869888410336;13.747667559844469309 0.2216685432344359663 -10.987817485379572702 10.633562161473737007 -1.6462875786595960736 -4.0119987518280026961 -3.7861099812761866978 -3.9075219049448941533 5.3925900691975137136 3.118837169922395347 -5.7736723939925749249 8.9246643263567140281 2.449369899644962878 -8.3852426535257542639 3.6648135883863481865;-6.4338384897161065012 4.9111336168187191831 6.0715537833362995812 0.80246659472815162761 3.631998828999647877 -5.8869455080203865194 1.6058639065741040497 0.30455115968926121939 -1.7018768607176242291 1.442177284655716818 -2.7890627085606967128 -4.5022400624746445885 -5.7192347306375914684 -0.15164619443743848626 -1.0658903217068433911;-2.6850893493716272431 4.0740525681175077111 -1.4581474503899625184 2.226352175377816156 6.6483667798535091009 -3.7060190696325601145 2.476267274094900106 -3.9190657112681153151 -0.65337305967625380898 3.9052706490092319314 0.39258172111436639984 -3.3758183808701556217 0.71633771015241753943 -3.1489315017214192238 -2.3507571616363227562;-4.4816530402723824267 -0.54077946399772258701 3.1855583376687008901 0.57795725220556526391 3.2426960818834356104 -3.0969395451276855447 0.93746842901851257235 3.5099051173695330341 0.8146773503377258141 -3.2903948194978180908 -0.26475922241657329215 -5.7481364920835016363 0.90912148049342234035 -1.1383306302202882421 -4.2317868914296923322;4.5597874219884202418 -0.60468210005910005833 4.5762100960203788702 2.2301927831071055586 0.020769614650375575055 -1.620249209848293237 -4.4342956836858498093 5.0168601697512240634 -3.4102265720283488903 -4.4698918719934424004 0.95030674163925343834 9.3640039177998328768 0.99922418709658100688 3.0773190778744257123 -1.1464734468623356545;9.2079760897326892177 2.74233352057334967 -1.4694435517743820174 10.037182997653550487 -12.23835384943613569 -1.0600061443746160439 9.1385907481285588716 0.74006661076700841484 -0.68285166938766150846 -1.9077084278976537135 -6.8418265418923898125 8.4441105925872701476 1.8876115140256664038 -4.9396091579732219756 7.8076919423303117185;-1.2958446877766138794 -0.14618073672371645344 1.0350187244326956026 6.1911471368046395725 -1.1965880840414417907 0.4994769154739726047 4.1039366533941725734 2.4822861950608756665 -3.7528188922423186824 -3.2057698512392640566 -3.885722390778262092 -1.4860180338881798789 -0.32842140232635480546 -1.3914720100374966538 -0.54140522798402046512;-1.7123086324634839706 1.4522810064647637684 1.2080170430551981919 1.2035550440584974474 0.98840837177274254444 3.6986498601071198244 2.8097020831693932941 -0.68147226597696131112 -0.56035039740508929551 1.6317921204283145631 -7.3965571380387471478 -0.58781864332657185468 -7.296518801609415128 0.079092619810915754108 -7.8101941225426863014;-8.4282743787160825377 1.529374792205147271 -6.6380478443107211461 -10.37988653072120826 3.6204863971105192277 9.1903388396391907378 -0.5126940861271034322 -1.5109673075349492333 2.351992330097985473 1.5655400919983746277 3.5305602968200662239 -8.6628244647196979145 1.6729642351596434313 8.1978195182815216668 -0.2092055235827679216;2.627496770537373294 2.0082025184324807654 3.1062625787129816146 -2.9532774581412000181 0.77063194169189785931 3.8021143635446765785 -3.1370471704749602893 -2.0441488931604254731 -0.50615391270957177383 -0.1202738748437840316 -2.5178060463683835657 3.8221224427420037451 1.4267171163750369534 6.8273757044695475571 -2.5788637020609539441;4.0224506124044987487 0.33418379199079428776 -3.2911068658833451117 2.1054704806045636545 -2.1481889489603398502 3.8144567884741205077 -0.30279066956050010306 -4.9369806320668763178 0.21455290528162840324 3.478222706399701103 -4.4930440330128034176 1.9917778538542216804 2.8670807381321239404 -0.084084857788744069018 -1.597958046679113453];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = softmax_apply(repmat(b3,1,Q) + LW3_2*a2);

% Output 1
y1 = a3;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
